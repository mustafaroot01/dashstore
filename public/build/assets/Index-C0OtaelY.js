import{q as u,h as D,c as F,w as C,a as e,u as i,g as p,i as y,t as b,b as j,v as T,o,d as a,F as M,e as $,j as w,f,n as I,k as N}from"./app-DA7iJFsN.js";import{A}from"./AdminLayout-CzmyY--h.js";import{M as H}from"./Modal-Bzv1YVbA.js";import{C as q}from"./ConfirmModal-BLS3Vsu-.js";import{_ as G}from"./StatusBadge-JAdWDZPH.js";/* empty css            */const R={class:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},z={class:"flex items-center gap-2 mb-1"},J={class:"text-slate-500 text-sm"},W={class:"font-bold text-primary"},X={class:"card p-0 mb-6"},K={class:"p-4 border-b border-slate-100"},Q={class:"relative max-w-md"},Y={class:"overflow-x-auto"},Z={class:"w-full text-right"},ee={class:"p-4"},te={class:"w-12 h-12 rounded-lg bg-slate-100 border border-slate-200 overflow-hidden flex items-center justify-center"},se=["src"],le={key:1,class:"fas fa-image text-slate-300"},oe={class:"p-4 font-medium text-slate-800"},ae={class:"p-4 text-slate-600"},re={class:"bg-slate-100 text-slate-600 px-2 py-1 rounded-md text-xs font-semibold"},ie={class:"p-4"},ne=["onClick"],de={class:"p-4"},ce={class:"flex items-center justify-center gap-2"},ue=["onClick"],fe=["onClick"],me={key:0},ge={key:0,class:"p-4 border-t border-slate-100 flex items-center justify-center gap-1"},pe=["onClick","innerHTML","disabled"],be={class:"space-y-4"},ve={class:"form-group"},xe={key:0,class:"text-red-500 text-xs mt-1"},ye={class:"form-group"},he={class:"form-label"},_e={key:0},we={class:"mt-1 flex items-center gap-4"},ke={class:"w-20 h-20 rounded-xl border border-slate-200 overflow-hidden bg-slate-50 flex items-center justify-center shrink-0"},Ce=["src"],je={key:1,class:"fas fa-image text-slate-300 text-2xl"},Te={class:"flex-1"},Me={key:0,class:"text-red-500 text-xs mt-1"},$e={class:"mt-6 flex justify-end gap-3 ext-action-buttons"},Se=["disabled"],Oe={key:0,class:"fas fa-spinner fa-spin mr-2"},Fe={__name:"Index",props:{category:Object,subcategories:Object,filters:Object},setup(n){const c=n,h=u(c.filters?.search??"");let k=null;function S(){clearTimeout(k),k=setTimeout(()=>{p.get(route("admin.categories.subcategories.index",c.category.id),{search:h.value},{preserveState:!0})},300)}const d=u(!1),m=u(!1),v=u(!1),_=u(null),l=D({id:null,name:"",image:null}),g=u(null);function O(r){const t=r.target.files[0];t&&(l.image=t,g.value=URL.createObjectURL(t))}function B(){m.value=!1,l.reset(),l.clearErrors(),g.value=null,d.value=!0}function E(r){m.value=!0,l.reset(),l.clearErrors(),l.id=r.id,l.name=r.name,l.image=null,g.value=r.image_url,d.value=!0}function L(){m.value?l.post(route("admin.categories.subcategories.update",{category:c.category.id,subcategory:l.id}),{forceFormData:!0,onSuccess:()=>{d.value=!1,l.reset()},headers:{"X-HTTP-Method-Override":"PUT"}}):l.post(route("admin.categories.subcategories.store",c.category.id),{onSuccess:()=>{d.value=!1,l.reset()}})}function P(r){_.value=r,v.value=!0}function U(){_.value&&p.delete(route("admin.categories.subcategories.destroy",{category:c.category.id,subcategory:_.value.id}),{onSuccess:()=>v.value=!1})}function V(r){p.post(route("admin.categories.subcategories.toggle-active",{category:c.category.id,subcategory:r.id}),{},{preserveScroll:!0})}return(r,t)=>(o(),F(A,{title:"الأصناف الفرعية"},{default:C(()=>[e("div",R,[e("div",null,[e("div",z,[e("button",{onClick:t[0]||(t[0]=s=>i(p).visit(r.route("admin.categories.index"))),class:"text-slate-400 hover:text-primary transition-colors"},[...t[6]||(t[6]=[e("i",{class:"fas fa-arrow-right"},null,-1)])]),t[7]||(t[7]=e("h1",{class:"text-2xl font-bold text-slate-800"},"الأصناف الفرعية",-1))]),e("p",J,[t[8]||(t[8]=y("إدارة الأصناف التابعة لقسم: ",-1)),e("span",W,b(n.category.name),1)])]),e("button",{onClick:B,class:"btn-primary w-full sm:w-auto"},[...t[9]||(t[9]=[e("i",{class:"fas fa-plus mr-2"},null,-1),y(" إضافة صنف فرعي ",-1)])])]),e("div",X,[e("div",K,[e("div",Q,[j(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>h.value=s),onInput:S,type:"text",class:"form-input pl-10",placeholder:"ابحث عن صنف فرعي..."},null,544),[[T,h.value]]),t[10]||(t[10]=e("i",{class:"fas fa-search absolute left-3 top-3 text-slate-400"},null,-1))])]),e("div",Y,[e("table",Z,[t[14]||(t[14]=e("thead",null,[e("tr",{class:"bg-slate-50 text-slate-500 text-sm border-b border-slate-100"},[e("th",{class:"p-4 font-semibold"},"الصورة"),e("th",{class:"p-4 font-semibold"},"اسم الصنف"),e("th",{class:"p-4 font-semibold"},"عدد المنتجات"),e("th",{class:"p-4 font-semibold"},"الحالة"),e("th",{class:"p-4 font-semibold text-center"},"الإجراءات")])],-1)),e("tbody",null,[(o(!0),a(M,null,$(n.subcategories.data,s=>(o(),a("tr",{key:s.id,class:"border-b border-slate-50 hover:bg-slate-50/50 transition-colors"},[e("td",ee,[e("div",te,[s.image_url?(o(),a("img",{key:0,src:s.image_url,class:"w-full h-full object-cover",alt:"Image"},null,8,se)):(o(),a("i",le))])]),e("td",oe,b(s.name),1),e("td",ae,[e("span",re,b(s.products_count)+" منتج ",1)]),e("td",ie,[e("button",{onClick:x=>V(s),class:"focus:outline-none"},[w(G,{status:s.is_active,activeText:"نشط",inactiveText:"مخفي"},null,8,["status"])],8,ne)]),e("td",de,[e("div",ce,[e("button",{onClick:x=>E(s),class:"w-8 h-8 rounded-lg text-blue-500 hover:bg-blue-50 flex items-center justify-center transition-colors",title:"تعديل"},[...t[11]||(t[11]=[e("i",{class:"fas fa-edit"},null,-1)])],8,ue),e("button",{onClick:x=>P(s),class:"w-8 h-8 rounded-lg text-red-500 hover:bg-red-50 flex items-center justify-center transition-colors",title:"حذف"},[...t[12]||(t[12]=[e("i",{class:"fas fa-trash-alt"},null,-1)])],8,fe)])])]))),128)),n.subcategories.data.length===0?(o(),a("tr",me,[...t[13]||(t[13]=[e("td",{colspan:"5",class:"p-8 text-center text-slate-500"},[e("div",{class:"flex flex-col items-center justify-center"},[e("i",{class:"fas fa-folder-open text-4xl text-slate-300 mb-3"}),e("p",null,"لا توجد أصناف فرعية، ابدأ بإضافة صنف جديد.")])],-1)])])):f("",!0)])])]),n.subcategories.links&&n.subcategories.links.length>3?(o(),a("div",ge,[(o(!0),a(M,null,$(n.subcategories.links,(s,x)=>(o(),a("button",{key:x,onClick:Be=>s.url?i(p).get(s.url):null,innerHTML:s.label,class:I(["px-3 py-1 text-sm rounded-md border transition-colors",[s.active?"bg-primary border-primary text-white":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50",s.url?"":"opacity-50 cursor-not-allowed"]]),disabled:!s.url},null,10,pe))),128))])):f("",!0)]),w(H,{show:d.value,title:m.value?"تعديل الصنف الفرعي":"إضافة صنف فرعي جديد",onClose:t[4]||(t[4]=s=>d.value=!1)},{default:C(()=>[e("form",{onSubmit:N(L,["prevent"])},[e("div",be,[e("div",ve,[t[15]||(t[15]=e("label",{class:"form-label"},"اسم الصنف الفرعي *",-1)),j(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>i(l).name=s),type:"text",class:"form-input",required:"",placeholder:"مثال: مياه غازية"},null,512),[[T,i(l).name]]),i(l).errors.name?(o(),a("p",xe,b(i(l).errors.name),1)):f("",!0)]),e("div",ye,[e("label",he,[t[16]||(t[16]=y("صورة الصنف ",-1)),m.value?f("",!0):(o(),a("span",_e,"*"))]),e("div",we,[e("div",ke,[g.value?(o(),a("img",{key:0,src:g.value,class:"w-full h-full object-cover"},null,8,Ce)):(o(),a("i",je))]),e("div",Te,[e("input",{type:"file",onChange:O,accept:"image/*",class:"w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20 transition-colors"},null,32),t[17]||(t[17]=e("p",{class:"text-xs text-slate-400 mt-2"},"صيغ مدعومة: JPG, PNG, WEBP. حجم أقصى: 2MB",-1))])]),i(l).errors.image?(o(),a("p",Me,b(i(l).errors.image),1)):f("",!0)])]),e("div",$e,[e("button",{type:"button",onClick:t[3]||(t[3]=s=>d.value=!1),class:"btn-light"},"إلغاء"),e("button",{type:"submit",class:"btn-primary",disabled:i(l).processing},[i(l).processing?(o(),a("i",Oe)):f("",!0),t[18]||(t[18]=y(" حفظ ",-1))],8,Se)])],32)]),_:1},8,["show","title"]),w(q,{show:v.value,title:"حذف الصنف الفرعي",message:"هل أنت متأكد من رغبتك في حذف هذا الصنف النهائي؟ لا يمكن التراجع عن هذا الإجراء.",confirmText:"نعم، احذف الصنف",onConfirm:U,onClose:t[5]||(t[5]=s=>v.value=!1)},null,8,["show"])]),_:1}))}};export{Fe as default};
