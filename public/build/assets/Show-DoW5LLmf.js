import{h as q,I as L,c as E,w,a as t,j as y,u as d,l as H,i as u,o as l,d as i,F as x,e as g,t as o,f as a,k as N,b as m,m as _,v as k,g as I,p as j,q as A}from"./app-DA7iJFsN.js";import{A as O}from"./AdminLayout-CzmyY--h.js";import{_ as U}from"./StatusBadge-JAdWDZPH.js";import{M as D}from"./Modal-Bzv1YVbA.js";/* empty css            */const F={class:"flex items-center gap-3 mb-6 no-print"},Q=["value"],T=["value"],$={id:"invoice",class:"bg-white rounded-xl shadow-[0_0_20px_rgba(0,0,0,0.02)] border border-slate-100 max-w-[800px] mx-auto p-4 md:p-10 relative overflow-hidden print:w-full print:shadow-none print:border-none print:p-0"},R={class:"flex justify-between items-end pb-6 border-b-2 border-slate-100 mb-8 mt-2"},G={class:"flex items-center gap-5"},J={key:0,class:"w-20 h-20 bg-slate-50 rounded-xl flex items-center justify-center p-2 border border-slate-100"},K=["src"],P={class:"font-extrabold text-2xl md:text-3xl text-slate-800 tracking-tight mb-1"},W={class:"text-slate-500 font-medium text-sm flex flex-col gap-0.5"},X={class:"flex items-center gap-1.5"},Y={dir:"ltr"},Z={class:"flex items-center gap-1.5"},tt={class:"text-left bg-slate-50/80 px-5 py-3 rounded-lg border border-slate-100"},et={class:"font-bold text-3xl text-primary-700 font-mono tracking-tighter"},st={class:"text-slate-500 text-sm mt-1 mb-2 font-medium print:text-[11px]"},ot={class:"flex flex-col md:flex-row gap-6 mb-8 mt-2"},rt={class:"flex-1 bg-blue-50/40 p-5 rounded-2xl border border-blue-50/60 relative overflow-hidden"},nt={class:"font-extrabold text-slate-800 text-xl {{ order.user?.first_name.length > 20 ? 'text-lg' : '' }}"},lt={class:"text-slate-600 font-medium font-mono mt-1 text-sm tracking-widest",dir:"ltr"},it={class:"flex-1 bg-amber-50/40 p-5 rounded-2xl border border-amber-50/60 relative overflow-hidden"},dt={class:"flex flex-wrap items-center gap-1.5 mb-1.5"},at={class:"font-bold text-slate-800 text-lg"},pt={key:0,class:"text-slate-400 font-bold"},ut={key:1,class:"font-bold text-slate-800 text-lg"},ct={class:"text-slate-500 text-sm leading-relaxed max-w-[90%]"},xt={class:"rounded-xl overflow-hidden border border-slate-200 mb-8 ring-1 ring-slate-100 ring-offset-1 print:border-slate-300 print:shadow-none print:ring-0"},bt={class:"w-full text-right bg-white"},mt={class:"divide-y divide-slate-100 print:divide-slate-200"},ft={class:"px-5 py-4 print:py-2 print:px-2 text-center text-slate-400 font-mono text-xs"},gt={class:"px-5 py-4 print:py-2 print:px-2"},vt={class:"flex items-center gap-3 print:gap-2 w-max max-w-full"},ht={key:0,class:"w-9 h-9 min-w-9 print:w-6 print:h-6 print:min-w-6 rounded-md border border-slate-200 bg-white p-0.5 shadow-sm group-hover:scale-105 transition-transform"},wt=["src"],yt={class:"flex flex-col"},kt={class:"font-bold text-slate-800 text-[15px] print:text-[13px] leading-tight flex flex-wrap items-center gap-1.5"},_t={key:0,class:"text-[10px] bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded-md font-normal whitespace-nowrap border border-slate-200 print:bg-transparent print:border-none print:px-0"},jt={key:0,class:"text-[10px] text-slate-400 font-mono mt-0.5 print:text-[9px]"},Ct={key:1,class:"text-[11px] print:text-[10px] text-slate-500 font-medium mt-0.5 text-right w-full"},Mt={class:"px-5 py-4 print:py-2 print:px-2"},zt={class:"mx-auto w-10 print:w-auto text-center font-bold text-slate-700 bg-slate-50 print:bg-transparent rounded-lg py-1 border border-slate-100 print:border-none print:py-0"},Vt={class:"px-5 py-4 print:py-2 print:px-2 text-left font-medium tracking-tighter text-slate-500 font-mono text-sm print:text-xs"},Bt={class:"px-5 py-4 print:py-2 print:px-2 text-left font-bold text-slate-800 tracking-tighter font-mono bg-slate-50/30 print:bg-transparent print:text-xs"},St={class:"flex flex-col md:flex-row gap-8 items-start justify-between"},qt={class:"w-full md:w-1/2"},Lt={key:0,class:"p-4 bg-slate-50 rounded-xl border border-slate-200 border-dashed text-slate-600"},Et={class:"text-sm leading-relaxed italic"},Ht={class:"w-full md:w-72 bg-slate-50 rounded-2xl p-5 border border-slate-200 shadow-sm print:shadow-none print:border-none print:bg-transparent print:p-0 print:break-inside-avoid"},Nt={class:"space-y-3.5 mb-4"},It={class:"flex justify-between items-center text-slate-600 text-sm"},At={class:"font-bold font-mono"},Ot={key:0,class:"flex justify-between items-center text-rose-600 bg-rose-50 px-2 py-1 -mx-2 rounded border border-rose-100/50 print:bg-transparent print:border-none print:px-0 print:mx-0"},Ut={class:"font-medium text-xs flex items-center gap-1"},Dt={class:"font-bold font-mono"},Ft={class:"flex justify-between items-end border-t border-slate-200/80 pt-4 print:border-slate-300"},Qt={class:"font-black text-2xl text-primary-700 font-mono tracking-tighter"},Tt={class:"mt-16 pt-6 border-t border-slate-200 flex items-center justify-between"},$t={class:"text-center w-24 flex-shrink-0 relative group"},Rt=["src"],Gt={class:"text-[9px] uppercase tracking-widest text-slate-400 mt-2 font-mono font-bold"},Jt={key:0,class:"text-left text-slate-500 text-[11px] leading-relaxed max-w-[60%] print:text-black"},Kt={class:"flex flex-col gap-1 items-end"},Pt={class:"font-semibold"},Wt={class:"p-6"},Xt={class:"space-y-4"},Yt={class:"grid grid-cols-2 gap-4"},Zt=["value"],te={key:0,class:"text-red-500 text-xs mt-1"},ee=["disabled"],se=["value"],oe={key:0,class:"text-red-500 text-xs mt-1"},re={key:0,class:"text-red-500 text-xs mt-1"},ne={key:0,class:"text-red-500 text-xs mt-1"},le={key:0,class:"text-red-500 text-xs mt-1"},ie={class:"mt-6 flex justify-end gap-3 pt-4 border-t border-slate-100"},de=["disabled"],ae={key:0,class:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},me={__name:"Show",props:{order:Object,settings:Object,statuses:Object,governorates:Array},setup(r){const p=r;function b(c){return Number(c??0).toLocaleString("ar-IQ")+" د.ع"}const C=j(()=>(p.order.items??[]).reduce((c,e)=>c+e.price*e.quantity,0));function M(c){I.patch(route("admin.orders.status",p.order.id),{status:c.target.value},{preserveScroll:!0})}function z(){window.print()}const v=A(!1),n=q({governorate_id:p.order.governorate_id||p.order.district?.governorate_id||"",district_id:p.order.district_id||null,phone:p.order.phone,delivery_point:p.order.delivery_point,notes:p.order.notes||""}),V=j(()=>{const c=(p.governorates||[]).find(e=>e.id===n.governorate_id);return c?c.districts:[]});L(()=>n.governorate_id,(c,e)=>{e&&c!==e&&(n.district_id=null)});function B(){n.governorate_id=p.order.governorate_id||p.order.district?.governorate_id||"",n.district_id=p.order.district_id||null,n.phone=p.order.phone,n.delivery_point=p.order.delivery_point,n.notes=p.order.notes||"",v.value=!0}function h(){v.value=!1,n.clearErrors()}function S(){n.put(route("admin.orders.update",p.order.id),{preserveScroll:!0,onSuccess:()=>h()})}return(c,e)=>(l(),E(O,{title:"طلب #"+r.order.invoice_number},{default:w(()=>[t("div",F,[y(d(H),{href:c.route("admin.orders.index"),class:"bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-xl text-sm font-bold hover:bg-slate-50 transition-all flex items-center gap-2 shadow-sm"},{default:w(()=>[...e[5]||(e[5]=[u(" ← الطلبات ",-1)])]),_:1},8,["href"]),t("button",{onClick:z,class:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-xl text-sm font-bold flex items-center gap-2 transition-all shadow-lg shadow-blue-500/20 active:scale-95"},[...e[6]||(e[6]=[t("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1),u(" طباعة الفاتورة ",-1)])]),t("button",{onClick:B,class:"bg-indigo-50 border border-indigo-100 text-indigo-700 px-5 py-2.5 rounded-xl text-sm font-bold flex items-center gap-2 hover:bg-indigo-100 transition-all active:scale-95"},[...e[7]||(e[7]=[t("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),u(" تعديل الطلب ",-1)])]),t("select",{value:r.order.status,onChange:M,class:"form-select w-52 mr-auto"},[(l(!0),i(x,null,g(r.statuses,(s,f)=>(l(),i("option",{key:f,value:f},o(s.label||s),9,T))),128))],40,Q)]),t("div",$,[e[23]||(e[23]=t("div",{class:"absolute top-0 left-0 w-full h-1.5 bg-primary-600 no-print"},null,-1)),e[24]||(e[24]=t("div",{class:"hidden print:block absolute top-0 left-0 w-full h-2 bg-[#0ea5e9]"},null,-1)),t("div",R,[t("div",G,[r.settings.invoice_logo?(l(),i("div",J,[t("img",{src:"/storage/"+r.settings.invoice_logo,class:"w-full h-full object-contain"},null,8,K)])):a("",!0),t("div",null,[t("h1",P,o(r.settings.invoice_name||"أمواج ديالى"),1),t("div",W,[t("p",X,[e[8]||(e[8]=t("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),e[9]||(e[9]=u()),t("span",Y,o(r.settings.invoice_phone),1)]),t("p",Z,[e[10]||(e[10]=t("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),u(" "+o(r.settings.invoice_address),1)])])])]),t("div",tt,[e[11]||(e[11]=t("p",{class:"text-slate-400 text-xs font-bold uppercase tracking-widest mb-1.5 text-right"},"INVOICE NO.",-1)),t("p",et,o(r.order.invoice_number),1),t("p",st,o(new Date(r.order.created_at).toLocaleString("ar-IQ",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})),1),y(U,{status:r.order.status,label:r.order.status_label,class:"!text-[10px] print:hidden w-full text-center block"},null,8,["status","label"])])]),t("div",ot,[t("div",rt,[e[12]||(e[12]=t("div",{class:"absolute left-0 top-0 bottom-0 w-1 bg-blue-400 rounded-l-full print:bg-[#60a5fa] print:w-[3px]"},null,-1)),e[13]||(e[13]=t("p",{class:"text-blue-400 text-xs font-bold uppercase tracking-wider mb-2 flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),u(" معلومات الزبون ")],-1)),t("p",nt,o(r.order.user?.first_name)+" "+o(r.order.user?.last_name),1),t("p",lt,o(r.order.phone),1)]),t("div",it,[e[14]||(e[14]=t("div",{class:"absolute left-0 top-0 bottom-0 w-1 bg-amber-400 rounded-l-full print:bg-[#fbbf24] print:w-[3px]"},null,-1)),e[15]||(e[15]=t("p",{class:"text-amber-500 text-xs font-bold uppercase tracking-wider mb-2 flex items-center gap-1.5"},[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),u(" موقع التوصيل ")],-1)),t("div",dt,[t("span",at,o(r.order.governorate?.name||r.order.district?.governorate?.name),1),r.order.district_id?(l(),i("span",pt,"—")):a("",!0),r.order.district_id?(l(),i("span",ut,o(r.order.district?.name),1)):a("",!0)]),t("p",ct,o(r.order.delivery_point),1)])]),t("div",xt,[t("table",bt,[e[16]||(e[16]=t("thead",{class:"bg-slate-100 border-b-2 border-slate-200 text-slate-600 print:bg-slate-100 print:table-header-group"},[t("tr",null,[t("th",{class:"px-5 py-3.5 print:py-2 print:px-2 text-sm print:text-xs font-bold w-12 text-center text-slate-400"},"#"),t("th",{class:"px-5 py-3.5 print:py-2 print:px-2 text-sm print:text-xs font-bold"},"المنتج التفصيلي"),t("th",{class:"px-5 py-3.5 print:py-2 print:px-2 text-sm print:text-xs font-bold text-center w-28 print:w-20"},"الكمية"),t("th",{class:"px-5 py-3.5 print:py-2 print:px-2 text-sm print:text-xs font-bold tracking-tight text-left w-36 print:w-28"},"سعر الوحدة"),t("th",{class:"px-5 py-3.5 print:py-2 print:px-2 text-sm print:text-xs font-bold tracking-tight text-left w-40 print:w-32 bg-slate-50/50 print:bg-transparent"},"المجموع")])],-1)),t("tbody",mt,[(l(!0),i(x,null,g(r.order.items,(s,f)=>(l(),i("tr",{key:s.id,class:"hover:bg-slate-50/40 transition-colors group print:break-inside-avoid"},[t("td",ft,o(f+1),1),t("td",gt,[t("div",vt,[s.product?.first_image?(l(),i("div",ht,[t("img",{src:s.product.first_image.url,class:"w-full h-full object-cover rounded-sm"},null,8,wt)])):a("",!0),t("div",yt,[t("span",kt,[u(o(s.product?.name)+" ",1),s.product?.subcategory?(l(),i("span",_t," ("+o(s.product.subcategory.name)+") ",1)):a("",!0)]),s.product?.sku?(l(),i("span",jt,o(s.product.sku),1)):a("",!0),s.variant?.color||s.variant?.size?(l(),i("span",Ct,[s.variant?.color?(l(),i(x,{key:0},[u("اللون: "+o(s.variant.color),1)],64)):a("",!0),s.variant?.color&&s.variant?.size?(l(),i(x,{key:1},[u(" | ")],64)):a("",!0),s.variant?.size?(l(),i(x,{key:2},[u("المقاس: "+o(s.variant.size),1)],64)):a("",!0)])):a("",!0)])])]),t("td",Mt,[t("div",zt,o(s.quantity),1)]),t("td",Vt,o(b(s.price)),1),t("td",Bt,o(b(s.price*s.quantity)),1)]))),128))])])]),t("div",St,[t("div",qt,[r.order.notes?(l(),i("div",Lt,[e[17]||(e[17]=t("span",{class:"font-bold block mb-2 text-slate-700 text-sm"},"ملاحظات الطلبية:",-1)),t("p",Et,o(r.order.notes),1)])):a("",!0)]),t("div",Ht,[t("div",Nt,[t("div",It,[e[18]||(e[18]=t("span",{class:"font-medium"},"المجموع الجزئي",-1)),t("span",At,o(b(C.value)),1)]),r.order.discount_amount>0?(l(),i("div",Ot,[t("span",Ut,[e[19]||(e[19]=t("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),u(" خصم "+o(r.order.coupon?.code),1)]),t("span",Dt,"- "+o(b(r.order.discount_amount)),1)])):a("",!0)]),t("div",Ft,[e[20]||(e[20]=t("span",{class:"font-bold text-slate-800 text-sm"},[u("الإجمالي "),t("span",{class:"text-[10px] text-slate-400 font-normal block"},"المبلغ المستحق للدفع")],-1)),t("span",Qt,o(b(r.order.total_price)),1)])])]),t("div",Tt,[t("div",$t,[t("img",{src:`https://api.qrserver.com/v1/create-qr-code/?data=${r.order.invoice_number}&size=120x120`,class:"w-16 h-16 mx-auto border border-slate-200 p-0.5 rounded-lg bg-white group-hover:scale-110 transition-transform print:grayscale",alt:"QR Code"},null,8,Rt),t("p",Gt,o(r.order.invoice_number),1)]),r.settings.invoice_footer?(l(),i("div",Jt,[t("div",Kt,[e[21]||(e[21]=t("div",{class:"w-8 h-0.5 bg-slate-300 mb-1 rounded-full"},null,-1)),t("p",Pt,o(r.settings.invoice_footer),1),e[22]||(e[22]=t("p",{class:"text-slate-400 mt-2 text-[10px]"},"تم إنشاء هذه الوثيقة إلكترونياً ولا تحتاج إلى ختم حي.",-1))])])):a("",!0)])]),y(D,{show:v.value,onClose:h,"max-width":"lg"},{default:w(()=>[t("div",Wt,[e[34]||(e[34]=t("h2",{class:"text-xl font-bold text-slate-800 mb-6 flex items-center gap-2"},[t("svg",{class:"w-6 h-6 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),u(" تعديل تفاصيل الطلب ")],-1)),t("form",{onSubmit:N(S,["prevent"])},[t("div",Xt,[t("div",Yt,[t("div",null,[e[26]||(e[26]=t("label",{class:"form-label"},"المحافظة",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>d(n).governorate_id=s),class:"form-input",required:""},[e[25]||(e[25]=t("option",{value:"",disabled:""},"اختر المحافظة...",-1)),(l(!0),i(x,null,g(r.governorates,s=>(l(),i("option",{key:s.id,value:s.id},o(s.name),9,Zt))),128))],512),[[_,d(n).governorate_id]]),d(n).errors.governorate_id?(l(),i("p",te,o(d(n).errors.governorate_id),1)):a("",!0)]),t("div",null,[e[28]||(e[28]=t("label",{class:"form-label"},"القضاء",-1)),m(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>d(n).district_id=s),class:"form-input",disabled:!d(n).governorate_id},[e[27]||(e[27]=t("option",{value:null},"بدون قضاء (اختياري)",-1)),(l(!0),i(x,null,g(V.value,s=>(l(),i("option",{key:s.id,value:s.id},o(s.name),9,se))),128))],8,ee),[[_,d(n).district_id]]),d(n).errors.district_id?(l(),i("p",oe,o(d(n).errors.district_id),1)):a("",!0)])]),t("div",null,[e[29]||(e[29]=t("label",{class:"form-label"},"رقم الهاتف",-1)),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>d(n).phone=s),type:"text",class:"form-input font-mono min-w-full",dir:"ltr",required:""},null,512),[[k,d(n).phone]]),d(n).errors.phone?(l(),i("p",re,o(d(n).errors.phone),1)):a("",!0)]),t("div",null,[e[30]||(e[30]=t("label",{class:"form-label"},"نقطة الدالة / التوصيل",-1)),m(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>d(n).delivery_point=s),rows:"2",class:"form-textarea",required:""},null,512),[[k,d(n).delivery_point]]),d(n).errors.delivery_point?(l(),i("p",ne,o(d(n).errors.delivery_point),1)):a("",!0)]),t("div",null,[e[31]||(e[31]=t("label",{class:"form-label"},"ملاحظات الطلب",-1)),m(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>d(n).notes=s),rows:"3",class:"form-textarea"},null,512),[[k,d(n).notes]]),d(n).errors.notes?(l(),i("p",le,o(d(n).errors.notes),1)):a("",!0)])]),t("div",ie,[t("button",{type:"button",onClick:h,class:"btn-secondary"},"إلغاء"),t("button",{type:"submit",disabled:d(n).processing,class:"btn-primary flex items-center gap-2"},[d(n).processing?(l(),i("svg",ae,[...e[32]||(e[32]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):a("",!0),e[33]||(e[33]=u(" حفظ التعديلات ",-1))],8,de)])],32)])]),_:1},8,["show"])]),_:1},8,["title"]))}};export{me as default};
