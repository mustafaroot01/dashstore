import{q as c,h as B,c as N,w as re,a as e,b as I,v as P,t as i,i as m,o,d as r,F as D,e as U,n as x,k,x as ae,f as p,u,g as C,T as ie,j as R}from"./app-DA7iJFsN.js";import{A as ne}from"./AdminLayout-CzmyY--h.js";import{C as q}from"./ConfirmModal-BLS3Vsu-.js";/* empty css            */const de={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 gap-4"},ue={class:"flex items-center gap-3 w-full sm:w-auto"},ce={class:"relative w-full sm:w-64"},me={class:"text-slate-500 font-medium text-sm whitespace-nowrap bg-slate-100 px-3 py-1.5 rounded-lg"},fe={class:"space-y-3"},pe=["onClick"],xe={class:"flex items-center gap-3 flex-1 w-full"},be={class:"w-12 h-12 rounded-lg border border-slate-200 overflow-hidden bg-slate-50 shadow-sm shrink-0 flex items-center justify-center"},ge=["src"],ve={key:1,class:"fas fa-box text-slate-300 text-lg"},he={class:"flex flex-row items-center gap-3 flex-1"},ye={class:"text-base font-bold text-slate-800 flex items-center gap-2"},_e={class:"flex flex-wrap items-center gap-2 text-[11px] text-slate-500 font-medium border-r pr-3 border-slate-200"},we={class:"flex items-center gap-1.5 bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100"},ke={class:"flex items-center gap-1.5 bg-blue-50/50 text-blue-600 px-1.5 py-0.5 rounded border border-blue-100/50"},Ce=["onClick","title"],Se={class:"hidden sm:inline"},je=["onClick"],$e=["onClick"],Te={class:"w-8 h-8 flex items-center justify-center rounded-full bg-slate-50 text-slate-400 hover:bg-slate-100 hover:text-slate-600 transition-colors mr-1"},Ie={class:"flex items-center justify-between mb-3 border-b border-slate-200/50 pb-2"},Me={class:"font-bold text-slate-600 text-[13px] flex items-center gap-1.5"},Ee=["onClick"],Fe={key:0,class:"text-center py-4 bg-white rounded-lg border border-slate-200 border-dashed"},Pe={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2.5"},De={class:"flex items-center gap-2"},Ue={class:"w-10 h-10 rounded border border-slate-100 overflow-hidden shrink-0 flex items-center justify-center bg-slate-50"},Le=["src"],Oe={key:1,class:"fas fa-image text-slate-300 text-xs"},ze={class:"flex-1 min-w-0 flex items-start flex-col gap-1 pr-1"},Ve={class:"font-bold text-slate-700 text-[12px] truncate w-full"},Ae={class:"flex items-center gap-2 mt-0.5"},Be={class:"text-[10px] text-slate-400 font-medium tracking-tighter border-r pr-2 border-slate-200"},Ne={class:"flex flex-wrap items-center justify-start gap-1.5 opacity-100 lg:opacity-0 lg:group-hover/sub:opacity-100 transition-opacity pt-2 border-t border-slate-100"},Re=["onClick"],qe={class:"font-bold whitespace-nowrap"},He=["onClick"],Ge=["onClick"],Je={key:0,class:"card py-16 text-center shadow-sm"},We={key:1,class:"mt-6 flex justify-center pb-8"},Xe={class:"inline-flex items-center gap-1 bg-white p-1 rounded-xl shadow-sm border border-slate-200"},Ke=["onClick","innerHTML","disabled"],Qe={class:"modal-box max-w-md shadow-2xl scale-100 animate-in fade-in zoom-in-95 duration-200"},Ye={class:"flex items-center justify-between p-5 border-b border-slate-100 bg-slate-50/50 rounded-t-2xl"},Ze={class:"font-bold text-lg text-slate-800 flex items-center gap-2"},et={class:"form-group"},tt={key:0,class:"text-red-500 text-xs mt-1"},st={class:"form-group"},lt={class:"form-label font-semibold text-slate-700"},ot=["src"],rt={key:1,class:"py-6 flex flex-col items-center text-slate-400"},at={key:0,class:"text-red-500 text-xs mt-1"},it={class:"flex gap-3 pt-4 border-t border-slate-100"},nt=["disabled"],dt={key:0,class:"fas fa-spinner fa-spin mr-2"},ut={class:"modal-box max-w-md shadow-2xl scale-100 animate-in fade-in zoom-in-95 duration-200"},ct={class:"flex items-center justify-between p-5 border-b border-slate-100 bg-slate-50/50 rounded-t-2xl"},mt={class:"font-bold text-lg text-slate-800 flex items-center gap-2"},ft={class:"form-group"},pt={key:0,class:"text-red-500 text-xs mt-1"},xt={class:"form-group"},bt={class:"form-label font-semibold text-slate-700"},gt={class:"flex items-center gap-4"},vt=["src"],ht={key:1,class:"fas fa-image text-slate-300 text-3xl"},yt={class:"flex-1"},_t={key:0,class:"text-red-500 text-xs mt-1"},wt={class:"flex gap-3 pt-4 border-t border-slate-100"},kt=["disabled"],Ct={key:0,class:"fas fa-spinner fa-spin mr-2"},Mt={__name:"Index",props:{categories:Object,filters:Object},setup(h){const M=c(h.filters?.search??""),S=c([]);let L;function H(){clearTimeout(L),L=setTimeout(()=>{C.get(route("admin.categories.index"),{search:M.value},{preserveState:!0})},400)}function O(l){const t=S.value.indexOf(l);t>-1?S.value.splice(t,1):S.value.push(l)}function E(l){return S.value.includes(l)}const j=c(!1),f=c(null),y=c(null),_=c(null),d=B({name:"",image:null,_method:"POST"});function G(l){l.target.files[0]&&(d.image=l.target.files[0],y.value=URL.createObjectURL(d.image))}function z(){f.value=null,d.reset(),d.clearErrors(),y.value=null,j.value=!0}function J(l){f.value=l,d.reset(),d.clearErrors(),d.name=l.name,d.image=null,y.value=l.image?"/storage/"+l.image:null,j.value=!0}function F(){j.value=!1,f.value=null,d.reset(),y.value=null}function W(){const l=f.value?route("admin.categories.update",f.value.id):route("admin.categories.store");d._method=f.value?"PUT":"POST",d.post(l,{onSuccess:F})}function X(l){C.post(route("admin.categories.toggle-active",l.id),{},{preserveScroll:!0})}function K(l){_.value=l}function Q(){C.delete(route("admin.categories.destroy",_.value.id),{onFinish:()=>{_.value=null},preserveScroll:!0})}const $=c(!1),b=c(null),g=c(null),w=c(null),v=c(null),a=B({id:null,name:"",image:null});function Y(l){l.target.files[0]&&(a.image=l.target.files[0],w.value=URL.createObjectURL(a.image))}function Z(l){b.value=l,g.value=null,a.reset(),a.clearErrors(),w.value=null,$.value=!0}function ee(l,t){b.value=l,g.value=t,a.reset(),a.clearErrors(),a.id=t.id,a.name=t.name,a.image=null,w.value=t.image_url||"/storage/"+t.image,$.value=!0}function T(){$.value=!1,g.value=null,b.value=null,a.reset(),w.value=null}function te(){g.value?a.post(route("admin.categories.subcategories.update",{category:b.value.id,subcategory:a.id}),{forceFormData:!0,onSuccess:T,preserveScroll:!0,headers:{"X-HTTP-Method-Override":"PUT"}}):a.post(route("admin.categories.subcategories.store",b.value.id),{onSuccess:()=>{T(),E(b.value.id)||O(b.value.id)},preserveScroll:!0})}function se(l,t){C.post(route("admin.categories.subcategories.toggle-active",{category:l.id,subcategory:t.id}),{},{preserveScroll:!0})}function le(l,t){v.value={cat:l,sub:t}}function oe(){if(!v.value)return;const{cat:l,sub:t}=v.value;C.delete(route("admin.categories.subcategories.destroy",{category:l.id,subcategory:t.id}),{onSuccess:()=>{v.value=null},preserveScroll:!0})}return(l,t)=>(o(),N(ne,{title:"الأقسام والتصنيفات"},{default:re(()=>[e("div",de,[e("div",ue,[e("div",ce,[I(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>M.value=s),type:"text",placeholder:"ابحث عن قسم...",class:"form-input pl-10 w-full",onInput:H},null,544),[[P,M.value]]),t[9]||(t[9]=e("i",{class:"fas fa-search absolute left-3 top-3.5 text-slate-400"},null,-1))]),e("span",me,i(h.categories.total)+" قسم رئيسي",1)]),e("button",{onClick:z,class:"btn-primary w-full sm:w-auto shadow-md hover:shadow-lg transition-all"},[...t[10]||(t[10]=[e("i",{class:"fas fa-plus ml-2"},null,-1),m(" إضافة قسم جديد ",-1)])])]),e("div",fe,[(o(!0),r(D,null,U(h.categories.data,(s,V)=>(o(),r("div",{key:s.id,class:"bg-white border border-slate-200/80 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-300 relative group"},[e("div",{class:"p-3 sm:px-4 sm:py-3 flex flex-col lg:flex-row items-start lg:items-center justify-between gap-3 cursor-pointer select-none",onClick:n=>O(s.id)},[e("div",xe,[e("div",be,[s.image?(o(),r("img",{key:0,src:"/storage/"+s.image,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"},null,8,ge)):(o(),r("i",ve))]),e("div",he,[e("h3",ye,[m(i(s.name)+" ",1),e("span",{class:x(["text-[10px] px-1.5 py-0.5 rounded-full font-bold",s.is_active?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"])},i(s.is_active?"نشط":"مخفي"),3)]),e("div",_e,[e("span",we,[t[11]||(t[11]=e("i",{class:"fas fa-box-open text-primary-500"},null,-1)),m(" "+i(s.products_count)+" منتج رئيسي ",1)]),e("span",ke,[t[12]||(t[12]=e("i",{class:"fas fa-layer-group"},null,-1)),m(" "+i(s.subcategories.length)+" أصناف فرعية ",1)])])])]),e("div",{class:"flex items-center gap-1.5 lg:ml-3 w-full lg:w-auto justify-end border-t lg:border-t-0 border-slate-50 pt-2 lg:pt-0",onClick:t[1]||(t[1]=k(()=>{},["stop"]))},[e("button",{onClick:n=>X(s),class:x(["flex items-center gap-1 px-2.5 py-1 text-[11px] font-bold rounded transition-colors",s.is_active?"text-amber-600 bg-amber-50 hover:bg-amber-100":"text-emerald-600 bg-emerald-50 hover:bg-emerald-100"]),title:s.is_active?"إخفاء القسم":"تفعيل القسم"},[e("i",{class:x(["fas text-[10px]",s.is_active?"fa-eye-slash":"fa-eye"])},null,2),e("span",Se,i(s.is_active?"إخفاء":"إظهار"),1)],10,Ce),e("button",{onClick:n=>J(s),class:"flex items-center gap-1 px-2.5 py-1 text-[11px] font-bold rounded text-blue-600 bg-blue-50 hover:bg-blue-100 transition-colors"},[...t[13]||(t[13]=[e("i",{class:"fas fa-pen text-[10px]"},null,-1),e("span",{class:"hidden sm:inline"},"تعديل",-1)])],8,je),e("button",{onClick:n=>K(s),class:"flex items-center gap-1 px-2.5 py-1 text-[11px] font-bold rounded text-red-600 bg-red-50 hover:bg-red-100 transition-colors"},[...t[14]||(t[14]=[e("i",{class:"fas fa-trash text-[10px]"},null,-1),e("span",{class:"hidden sm:inline"},"حذف",-1)])],8,$e),e("button",Te,[e("i",{class:x(["fas text-[11px]",E(s.id)?"fa-chevron-up":"fa-chevron-down"])},null,2)])])],8,pe),I(e("div",{class:"border-t border-slate-100 bg-slate-50/50 p-3 sm:p-4 shadow-inner",onClick:t[2]||(t[2]=k(()=>{},["stop"]))},[e("div",Ie,[e("h4",Me,[t[15]||(t[15]=e("i",{class:"fas fa-level-down-alt fa-flip-horizontal text-primary-400"},null,-1)),m(" قائمة الأصناف الفرعية لـ "+i(s.name),1)]),e("button",{onClick:n=>Z(s),class:"px-2.5 py-1 text-[11px] font-bold text-primary-700 bg-white hover:bg-primary-50 border border-primary-200 rounded shadow-sm transition-colors"},[...t[16]||(t[16]=[e("i",{class:"fas fa-plus mr-0.5"},null,-1),m(" صنف جديد ",-1)])],8,Ee)]),s.subcategories.length?(o(),r("div",Pe,[(o(!0),r(D,null,U(s.subcategories,n=>(o(),r("div",{key:n.id,class:"bg-white border border-slate-200 rounded-md p-2 flex flex-col gap-2 hover:border-primary-300 transition-colors group/sub shadow-[0_1px_2px_rgba(0,0,0,0.02)]"},[e("div",De,[e("div",Ue,[n.image_url||n.image?(o(),r("img",{key:0,src:n.image_url||"/storage/"+n.image,class:"w-full h-full object-cover"},null,8,Le)):(o(),r("i",Oe))]),e("div",ze,[e("h5",Ve,i(n.name),1),e("div",Ae,[e("span",{class:x(["text-[9px] px-1.5 py-0.5 rounded font-bold",n.is_active?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"])},i(n.is_active?"نشط":"مخفي"),3),e("p",Be,i(n.products_count||0)+" منتج مربوط ",1)])])]),e("div",Ne,[e("button",{onClick:A=>se(s,n),class:x(["flex items-center gap-1 px-2 py-1 text-[10px] font-bold rounded transition-colors",n.is_active?"text-amber-600 bg-amber-50 hover:bg-amber-100":"text-emerald-600 bg-emerald-50 hover:bg-emerald-100"])},[e("span",qe,i(n.is_active?"إخفاء":"إظهار"),1)],10,Re),e("button",{onClick:A=>ee(s,n),class:"flex items-center gap-1 px-2 py-1 rounded bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors",title:"تعديل"},[...t[18]||(t[18]=[e("span",{class:"text-[10px] font-bold whitespace-nowrap"},"تعديل",-1)])],8,He),e("button",{onClick:A=>le(s,n),class:"flex items-center gap-1 px-2 py-1 rounded bg-red-50 text-red-600 hover:bg-red-100 transition-colors",title:"حذف"},[...t[19]||(t[19]=[e("span",{class:"text-[10px] font-bold whitespace-nowrap"},"حذف",-1)])],8,Ge)])]))),128))])):(o(),r("div",Fe,[...t[17]||(t[17]=[e("div",{class:"w-8 h-8 bg-slate-100 text-slate-400 rounded-full flex items-center justify-center mx-auto mb-1.5"},[e("i",{class:"fas fa-folder-open text-xs"})],-1),e("p",{class:"text-slate-500 text-xs font-medium"},"هذا القسم خالي من الأصناف الفرعية.",-1)])]))],512),[[ae,E(s.id)]])]))),128)),h.categories.data.length?p("",!0):(o(),r("div",Je,[t[21]||(t[21]=e("div",{class:"w-20 h-20 bg-slate-50 text-slate-300 rounded-full flex items-center justify-center mx-auto mb-4 border border-slate-100"},[e("i",{class:"fas fa-box-open text-3xl"})],-1)),t[22]||(t[22]=e("h3",{class:"text-xl font-bold text-slate-700 mb-2"},"لا يوجد أقسام مبنية",-1)),t[23]||(t[23]=e("p",{class:"text-slate-500 mb-6"},"ابدأ بناء متجرك الآن عبر إدراج الأقسام والعلامات التجارية.",-1)),e("button",{onClick:z,class:"btn-primary inline-flex"},[...t[20]||(t[20]=[e("i",{class:"fas fa-plus ml-2"},null,-1),m(" بناء قسم جديد",-1)])])])),h.categories.links&&h.categories.links.length>3?(o(),r("div",We,[e("div",Xe,[(o(!0),r(D,null,U(h.categories.links,(s,V)=>(o(),r("button",{key:V,onClick:n=>s.url?u(C).get(s.url):null,innerHTML:s.label,class:x(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",[s.active?"bg-primary-50 text-primary-700":"text-slate-600 hover:bg-slate-50",s.url?"":"opacity-40 cursor-not-allowed hidden md:inline-block"]]),disabled:!s.url},null,10,Ke))),128))])])):p("",!0)]),(o(),N(ie,{to:"body"},[j.value?(o(),r("div",{key:0,class:"modal-backdrop z-[60]",onClick:k(F,["self"])},[e("div",Qe,[e("div",Ye,[e("h3",Ze,[e("i",{class:x(["fas",f.value?"fa-edit text-blue-500":"fa-plus text-primary-500"])},null,2),m(" "+i(f.value?"تعديل بيانات القسم":"إضافة قسم جديد"),1)]),e("button",{onClick:F,class:"text-slate-400 hover:text-red-500 text-xl w-8 h-8 rounded-full flex items-center justify-center bg-white border border-slate-200 shadow-sm transition-colors"},"×")]),e("form",{onSubmit:k(W,["prevent"]),class:"p-6 space-y-5"},[e("div",et,[t[24]||(t[24]=e("label",{class:"form-label font-semibold text-slate-700"},"الاسم *",-1)),I(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>u(d).name=s),class:"form-input",required:"",placeholder:"مثال: قسم العصائر أو أجهزة منزلية"},null,512),[[P,u(d).name]]),u(d).errors.name?(o(),r("p",tt,i(u(d).errors.name),1)):p("",!0)]),e("div",st,[e("label",lt,i(f.value?"تغيير الصورة (اختياري)":"الصورة الافتراضية *"),1),e("div",{class:"image-drop-zone border-2 border-dashed border-slate-300 hover:border-primary-400 bg-slate-50 transition-colors rounded-xl cursor-pointer",onClick:t[4]||(t[4]=s=>l.$refs.catImgInput.click())},[y.value?(o(),r("img",{key:0,src:y.value,class:"w-full h-32 object-contain rounded-lg mx-auto"},null,8,ot)):(o(),r("div",rt,[...t[25]||(t[25]=[e("div",{class:"w-12 h-12 bg-white rounded-full shadow-sm flex items-center justify-center mb-3"},[e("i",{class:"fas fa-cloud-upload-alt text-2xl text-primary-400"})],-1),e("span",{class:"text-sm font-medium text-slate-600"},"انقر هنا لرفع أو تغيير الصورة",-1),e("span",{class:"text-xs mt-1"},"PNG, JPG, WEBP (حجم أقصى 2MB)",-1)])])),e("input",{ref:"catImgInput",type:"file",accept:"image/*",class:"hidden",onChange:G},null,544)]),u(d).errors.image?(o(),r("p",at,i(u(d).errors.image),1)):p("",!0)]),e("div",it,[e("button",{type:"submit",disabled:u(d).processing,class:"btn-primary flex-1 py-2.5"},[u(d).processing?(o(),r("i",dt)):p("",!0),m(" "+i(f.value?"حفظ التعديلات":"اعتماد وإنشاء القسم"),1)],8,nt)])],32)])])):p("",!0),$.value?(o(),r("div",{key:1,class:"modal-backdrop z-[60]",onClick:k(T,["self"])},[e("div",ut,[e("div",ct,[e("h3",mt,[e("i",{class:x(["fas",g.value?"fa-pen text-blue-500":"fa-plus text-primary-500"])},null,2),m(" "+i(g.value?"تعديل صنف فرعي":"إضافة صنف جديد لمنطقة: "+b.value?.name),1)]),e("button",{onClick:T,class:"text-slate-400 hover:text-red-500 text-xl w-8 h-8 rounded-full flex items-center justify-center bg-white border border-slate-200 shadow-sm"},"×")]),e("form",{onSubmit:k(te,["prevent"]),class:"p-6 space-y-5"},[e("div",ft,[t[26]||(t[26]=e("label",{class:"form-label font-semibold text-slate-700"},"اسم الصنف الفرعي *",-1)),I(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>u(a).name=s),class:"form-input",required:"",placeholder:"مثال: مياه غازية، فواكه، إلخ"},null,512),[[P,u(a).name]]),u(a).errors.name?(o(),r("p",pt,i(u(a).errors.name),1)):p("",!0)]),e("div",xt,[e("label",bt,i(g.value?"صورة جديدة (اختياري)":"الصورة المطلوبة للصنف *"),1),e("div",gt,[e("div",{class:"w-24 h-24 rounded-2xl border-2 border-slate-200 overflow-hidden bg-slate-50 flex items-center justify-center shrink-0 shadow-inner group relative cursor-pointer",onClick:t[6]||(t[6]=s=>l.$refs.subImgInput.click())},[w.value?(o(),r("img",{key:0,src:w.value,class:"w-full h-full object-cover group-hover:opacity-75 transition-opacity"},null,8,vt)):(o(),r("i",ht)),t[27]||(t[27]=e("div",{class:"absolute inset-0 bg-black/40 text-white flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},[e("i",{class:"fas fa-camera mb-1"}),e("span",{class:"text-[10px] font-bold"},"تغيير")],-1))]),e("div",yt,[e("input",{ref:"subImgInput",type:"file",onChange:Y,accept:"image/*",class:"w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100 transition-colors file:cursor-pointer"},null,544),t[28]||(t[28]=e("p",{class:"text-xs text-slate-400 mt-2 leading-relaxed"},"اسمح للزبائن بالتعرف على الصنف أسرع بصورة واضحة. يفضل مقاس مربع 1:1.",-1))])]),u(a).errors.image?(o(),r("p",_t,i(u(a).errors.image),1)):p("",!0)]),e("div",wt,[e("button",{type:"submit",disabled:u(a).processing,class:"btn-primary flex-1 py-2.5"},[u(a).processing?(o(),r("i",Ct)):p("",!0),m(" "+i(g.value?"تحديث الصنف التابع":"إضافة في الصنف"),1)],8,kt)])],32)])])):p("",!0)])),R(q,{show:!!_.value,title:"حذف القسم بالكامل",message:`هل أنت متأكد من حذف قسم "${_.value?.name}" بجميع بياناته والصور التابعة له بشكل نهائي؟`,"confirm-label":"نعم، حذف النهائي",onConfirm:Q,onCancel:t[7]||(t[7]=s=>_.value=null)},null,8,["show","message"]),R(q,{show:!!v.value,title:"حذف الصنف الفرعي",message:`احذر: هل تريد حقاً إزالة الصنف "${v.value?.sub?.name}" المندرج تحت قسم (${v.value?.cat?.name}) بشكل نهائي؟`,"confirm-label":"نعم، إزالة الصنف",onConfirm:oe,onCancel:t[8]||(t[8]=s=>v.value=null)},null,8,["show","message"])]),_:1}))}};export{Mt as default};
