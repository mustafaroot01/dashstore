import{q as _,h as F,c as N,w as k,a as t,j as B,u as o,l as M,i as w,k as $,b as d,v as p,o as r,d as a,t as x,f as m,F as b,e as g,m as z,A as V,p as q}from"./app-IK5CPhZk.js";import{A as T}from"./AdminLayout-DOrr8jPw.js";/* empty css            */const O={class:"max-w-3xl mx-auto"},D={class:"flex items-center justify-end mb-4"},G={class:"card space-y-5"},H={class:"grid grid-cols-2 gap-4"},R={class:"form-group col-span-2 sm:col-span-1"},X={key:0,class:"text-red-500 text-xs mt-1"},J={class:"form-group col-span-2 sm:col-span-1"},K={key:0,class:"text-red-500 text-xs mt-1"},W={class:"form-group col-span-2 sm:col-span-1"},Q=["value"],Y={key:0,class:"form-group col-span-2 sm:col-span-1"},Z=["value"],ee={class:"form-group"},te={class:"grid grid-cols-3 gap-4"},se={class:"form-group"},le={class:"form-group"},oe={class:"form-group"},re={class:"flex flex-wrap gap-6"},ae={class:"flex items-center gap-2 cursor-pointer"},ie={class:"flex items-center gap-2 cursor-pointer"},ne={class:"flex items-center gap-2 cursor-pointer"},de={class:"col-span-full border border-slate-200 rounded-xl p-4 bg-slate-50 space-y-4"},ue=["onClick"],pe={class:"form-group mb-0 flex-1 min-w-[120px]"},me=["onUpdate:modelValue"],ce={class:"form-group mb-0 flex-1 min-w-[120px]"},fe=["onUpdate:modelValue"],ve={class:"form-group mb-0 flex-1 min-w-[120px]"},xe=["onUpdate:modelValue"],be={key:0,class:"text-red-500 text-xs mt-1"},ge={class:"form-group"},ye={key:0,class:"flex flex-wrap gap-3 mb-3"},_e=["src"],we=["onClick"],he={key:1,class:"flex flex-wrap gap-3 mb-3"},ke=["src"],Ve=["onClick"],Ue={class:"text-xs text-slate-400 mt-1"},Ce=["max"],je={class:"flex items-center gap-3 mt-5"},Be=["disabled"],Me={key:0,class:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ae={__name:"Form",props:{product:Object,categories:Array},setup(U){const n=U,y=q(()=>!!n.product),c=_(n.product?.images??[]),C=_([]),f=_([]),h=_([]),j=q(()=>l?.category_id?n.categories.find(e=>e.id===l.category_id)?.subcategories||[]:[]),l=F({category_id:n.product?.category_id??"",subcategory_id:n.product?.subcategory_id??null,name:n.product?.name??"",sku:n.product?.sku??"",description:n.product?.description??"",price:n.product?.price??"",sale_price:n.product?.sale_price??"",is_on_sale:n.product?.is_on_sale??!1,cost_price:n.product?.cost_price??"",is_active:n.product?.is_active??!0,is_available:n.product?.is_available??!0,variants:n.product?.variants?.length?n.product.variants:[{id:null,color:"",size:"",stock:0}],images:[],deleted_images:[],_method:y.value?"PUT":"POST"});function L(){l.variants.push({id:null,color:"",size:"",stock:0})}function A(i){l.variants.length>1&&(l.variants[i].id,l.variants.splice(i,1))}function E(i){const e=Array.from(i.target.files),s=5-c.value.length-f.value.length;e.slice(0,s).forEach(u=>{h.value.push(u),f.value.push(URL.createObjectURL(u))}),i.target.value=""}function I(i){f.value.splice(i,1),h.value.splice(i,1)}function P(i){C.value.push(i),c.value=c.value.filter(e=>e.id!==i)}function S(){l.images=h.value,l.deleted_images=C.value;const i=y.value?route("admin.products.update",n.product.id):route("admin.products.store");l.post(i)}return(i,e)=>(r(),N(T,{title:y.value?"تعديل منتج":"إضافة منتج"},{default:k(()=>[t("div",O,[t("div",D,[B(o(M),{href:i.route("admin.products.index"),class:"flex items-center gap-2 text-sm font-bold text-slate-600 hover:text-primary-700 hover:bg-white transition-all bg-slate-50 px-4 py-2 rounded-xl border border-slate-200 hover:border-primary-200 shadow-sm w-fit"},{default:k(()=>[...e[12]||(e[12]=[t("i",{class:"fas fa-arrow-right text-xs"},null,-1),w(" العودة للمنتجات ",-1)])]),_:1},8,["href"])]),t("form",{onSubmit:$(S,["prevent"]),enctype:"multipart/form-data"},[t("div",G,[t("div",H,[t("div",R,[e[13]||(e[13]=t("label",{class:"form-label"},"اسم المنتج *",-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o(l).name=s),type:"text",class:"form-input",placeholder:"مثال: قارورة ماء 19 لتر",required:""},null,512),[[p,o(l).name]]),o(l).errors.name?(r(),a("p",X,x(o(l).errors.name),1)):m("",!0)]),t("div",J,[e[14]||(e[14]=t("label",{class:"form-label"},"رقم باركود/مسلسل (SKU)",-1)),d(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o(l).sku=s),type:"text",class:"form-input",placeholder:"مثال: ABC-123 (اختياري)"},null,512),[[p,o(l).sku]]),o(l).errors.sku?(r(),a("p",K,x(o(l).errors.sku),1)):m("",!0)]),t("div",W,[e[16]||(e[16]=t("label",{class:"form-label"},"القسم *",-1)),d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o(l).category_id=s),class:"form-select",required:""},[e[15]||(e[15]=t("option",{value:""},"اختر قسماً",-1)),(r(!0),a(b,null,g(U.categories,s=>(r(),a("option",{key:s.id,value:s.id},x(s.name),9,Q))),128))],512),[[z,o(l).category_id]])]),j.value.length>0?(r(),a("div",Y,[e[18]||(e[18]=t("label",{class:"form-label"},"الصنف الفرعي (اختياري)",-1)),d(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>o(l).subcategory_id=s),class:"form-select"},[e[17]||(e[17]=t("option",{value:""},"بدون صنف",-1)),(r(!0),a(b,null,g(j.value,s=>(r(),a("option",{key:s.id,value:s.id},x(s.name),9,Z))),128))],512),[[z,o(l).subcategory_id]])])):m("",!0)]),t("div",ee,[e[19]||(e[19]=t("label",{class:"form-label"},"الوصف *",-1)),d(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>o(l).description=s),class:"form-textarea",rows:"3",required:""},null,512),[[p,o(l).description]])]),t("div",te,[t("div",se,[e[20]||(e[20]=t("label",{class:"form-label"},"سعر البيع (د.ع) *",-1)),d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o(l).price=s),type:"number",min:"0",step:"0.01",class:"form-input",required:""},null,512),[[p,o(l).price]])]),t("div",le,[e[21]||(e[21]=t("label",{class:"form-label"},"سعر التكلفة (د.ع) *",-1)),d(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o(l).cost_price=s),type:"number",min:"0",step:"0.01",class:"form-input",required:""},null,512),[[p,o(l).cost_price]])]),t("div",oe,[e[22]||(e[22]=t("label",{class:"form-label"},"سعر الخصم (د.ع)",-1)),d(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o(l).sale_price=s),type:"number",min:"0",step:"0.01",class:"form-input"},null,512),[[p,o(l).sale_price]])])]),t("div",re,[t("label",ae,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=s=>o(l).is_on_sale=s),class:"rounded text-primary-600"},null,512),[[V,o(l).is_on_sale]]),e[23]||(e[23]=t("span",{class:"text-sm font-medium text-slate-700"},"تفعيل سعر الخصم",-1))]),t("label",ie,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=s=>o(l).is_active=s),class:"rounded text-primary-600"},null,512),[[V,o(l).is_active]]),e[24]||(e[24]=t("span",{class:"text-sm font-medium text-slate-700"},"ظاهر في التطبيق",-1))]),t("label",ne,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=s=>o(l).is_available=s),class:"rounded text-primary-600"},null,512),[[V,o(l).is_available]]),e[25]||(e[25]=t("span",{class:"text-sm font-medium text-slate-700"},"متوفر حالياً",-1))])]),t("div",de,[t("div",{class:"flex items-center justify-between"},[e[27]||(e[27]=t("div",null,[t("h3",{class:"font-bold text-slate-800 text-sm"},"الخيارات والمخزون"),t("p",{class:"text-xs text-slate-500 mt-0.5"},"أضف خيارات المنتج مثل الألوان والأحجام وكمية كل منها. إذا كان المنتج عاماً، أضف مخزونه فقط.")],-1)),t("button",{type:"button",onClick:L,class:"btn-secondary text-xs px-3 py-1.5 flex items-center gap-1"},[...e[26]||(e[26]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),w(" خيار جديد ",-1)])])]),(r(!0),a(b,null,g(o(l).variants,(s,u)=>(r(),a("div",{key:u,class:"flex flex-wrap items-end gap-3 bg-white p-3 rounded-lg border border-slate-200 relative"},[o(l).variants.length>1?(r(),a("button",{key:0,type:"button",onClick:v=>A(u),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 transition shadow-sm pb-0.5"},"×",8,ue)):m("",!0),t("div",pe,[e[28]||(e[28]=t("label",{class:"form-label text-xs mb-1"},"اللون (اختياري)",-1)),d(t("input",{"onUpdate:modelValue":v=>s.color=v,type:"text",class:"form-input text-sm py-1.5 px-2",placeholder:"أحمر، أسود، إلخ"},null,8,me),[[p,s.color]])]),t("div",ce,[e[29]||(e[29]=t("label",{class:"form-label text-xs mb-1"},"القياس (اختياري)",-1)),d(t("input",{"onUpdate:modelValue":v=>s.size=v,type:"text",class:"form-input text-sm py-1.5 px-2",placeholder:"M, 42, XXL"},null,8,fe),[[p,s.size]])]),t("div",ve,[e[30]||(e[30]=t("label",{class:"form-label text-xs mb-1 text-primary-700 font-bold"},"الكمية المتوفرة *",-1)),d(t("input",{"onUpdate:modelValue":v=>s.stock=v,type:"number",min:"0",class:"form-input text-sm py-1.5 px-2 border-primary-200 focus:border-primary-500 focus:ring-primary-500 bg-primary-50/50 font-bold text-primary-900",required:""},null,8,xe),[[p,s.stock]])])]))),128)),o(l).errors.variants?(r(),a("p",be,x(o(l).errors.variants),1)):m("",!0)]),t("div",ge,[e[33]||(e[33]=t("label",{class:"form-label"},"الصور (حتى 5 صور)",-1)),c.value.length?(r(),a("div",ye,[(r(!0),a(b,null,g(c.value,s=>(r(),a("div",{key:s.id,class:"relative group"},[t("img",{src:s.url,class:"w-20 h-20 rounded-xl object-cover border border-slate-200"},null,8,_e),t("button",{type:"button",onClick:u=>P(s.id),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full text-xs hidden group-hover:flex items-center justify-center"}," × ",8,we)]))),128))])):m("",!0),f.value.length?(r(),a("div",he,[(r(!0),a(b,null,g(f.value,(s,u)=>(r(),a("div",{key:u,class:"relative group"},[t("img",{src:s,class:"w-20 h-20 rounded-xl object-cover border-2 border-primary-200"},null,8,ke),t("button",{type:"button",onClick:v=>I(u),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full text-xs hidden group-hover:flex items-center justify-center"}," × ",8,Ve)]))),128))])):m("",!0),c.value.length+f.value.length<5?(r(),a("div",{key:2,class:"image-drop-zone",onClick:e[11]||(e[11]=s=>i.$refs.imgInput.click())},[e[31]||(e[31]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 mx-auto text-slate-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e[32]||(e[32]=t("p",{class:"text-sm text-slate-500"},"اضغط لاختيار صور",-1)),t("p",Ue,x(5-c.value.length-f.value.length)+" صور متبقية — JPEG/PNG/WEBP حتى 3MB",1),t("input",{ref:"imgInput",type:"file",multiple:"",accept:"image/*",class:"hidden",onChange:E,max:5-c.value.length},null,40,Ce)])):m("",!0)])]),t("div",je,[t("button",{type:"submit",disabled:o(l).processing,class:"btn-primary"},[o(l).processing?(r(),a("svg",Me,[...e[34]||(e[34]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):m("",!0),w(" "+x(y.value?"حفظ التعديلات":"إضافة المنتج"),1)],8,Be),B(o(M),{href:i.route("admin.products.index"),class:"btn-secondary"},{default:k(()=>[...e[35]||(e[35]=[w("إلغاء",-1)])]),_:1},8,["href"])])],32)])]),_:1},8,["title"]))}};export{Ae as default};
